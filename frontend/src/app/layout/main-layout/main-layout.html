<mat-toolbar class="app-header">
  <div class="container">
    <a class="logo" routerLink="/dashboard">
      <img src="assets/logo/worki.png" alt="Worki Logo">
    </a>

    <div class="navigation-links">
      <a routerLink="/dashboard" routerLinkActive="active-link">Encontrar Vagas</a>
      <a routerLink="/my-jobs" routerLinkActive="active-link">Meus Trabalhos</a>
      
      <a 
        routerLink="/messages/inbox" 
        routerLinkActive="active-link"
        [matBadge]="(hasUnreadMessages$ | async) ? '●' : null"
        [matBadgeHidden]="!(hasUnreadMessages$ | async)"
        matBadgeColor="warn"
        matBadgeSize="medium"
        matBadgePosition="above after"
        class="messages-link"
 >
        Mensagens
      </a>
    </div>

    <span class="spacer"></span>

    <button mat-icon-button class="notification-bell" [matMenuTriggerFor]="notificationMenu" (menuOpened)="onBellClick()">
      <mat-icon
        [matBadge]="(hasUnreadNotifications$ | async) ? '●' : null"
        [matBadgeHidden]="!(hasUnreadNotifications$ | async)"
        matBadgeColor="warn"
        matBadgeSize="small"
        matBadgePosition="above after" >notifications</mat-icon>
    </button>
    <mat-menu #notificationMenu="matMenu" class="notification-dropdown">
      <div class="notification-header">
        <h3>Notificações</h3>
      </div>
      
      <div class="notification-list">
        
        @if (notifications$ | async; as notifications) {
          
          @if (notifications.length > 0) {
            
            @for (notification of notifications; track notification.id) {
              <button mat-menu-item (click)="onNotificationClick(notification)">
                <span class="notification-message">{{ notification.message }}</span>
                <span class="notification-time">{{ notification.createdAt | date:'shortTime' }}</span>
              </button>
            }
          } @else {
            <span class="no-notifications">Nenhuma notificação nova.</span>
          }

        } @else {
           <span class="no-notifications">Nenhuma notificação nova.</span>
        }
      </div>
      </mat-menu>
    <button mat-icon-button [matMenuTriggerFor]="userMenu" class="user-menu-button">
      <mat-icon>account_circle</mat-icon>
    </button>
    
    <mat-menu #userMenu="matMenu">
      <button mat-menu-item (click)="navigateToProfile()">
        <mat-icon>person</mat-icon>
        <span>Meu Perfil</span>
      </button>
      <button mat-menu-item routerLink="/settings">
        <mat-icon>settings</mat-icon>
        <span>Configurações</span>
      </button>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        <span>Sair</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<main class="main-content-area">
  <router-outlet></router-outlet>
</main>